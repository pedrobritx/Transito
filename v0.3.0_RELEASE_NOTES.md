# Transito v0.3.0 - Release Notes

**Released**: January XX, 2024
**Version**: v0.3.0
**Status**: ✅ Development Complete, Ready for Testing

---

## 🎉 Major Milestone: Complete UI/UX Redesign

This release represents a comprehensive upgrade to Transito with a modern SwiftUI interface, intelligent subtitle extraction, persistent preferences, and enhanced CLI capabilities.

### ✨ What's New

#### 1. **Liquid Glass macOS UI** 🪟

- Modern SwiftUI interface replacing legacy Tkinter
- NSVisualEffectView materials with `.hudWindow` and `.thinMaterial` vibrancy
- AngularGradient accent overlay for visual depth
- Rounded corner cards with subtle shadows
- Full accessibility support (VoiceOver, labels, focus order)

#### 2. **Subtitle Extraction** 📝

- **CLI Flag**: `--extract-subtitles` saves WebVTT files alongside MP4
- **App Toggle**: "Extract subtitles" checkbox in main UI
- **Automatic Output**: Subtitles save as `filename.vtt` with same base name
- **Separate Process**: Runs after main download completes
- **Graceful Fallback**: Continues if subtitle stream unavailable

#### 3. **Preferences Window** ⚙️

- Native macOS Settings window (Cmd+, or menu)
- **UserDefaults Persistence**: Settings saved across app launches
- **Customizable Defaults**:
  - Default download folder with folder picker
  - Custom User-Agent header
  - Custom Referer header
  - Auto-open downloaded files toggle
- **Clean Form Interface**: Organized, intuitive settings

#### 4. **Enhanced CLI** 🖥️

```bash
# New subtitle extraction
transito url.m3u8 -o video.mp4 --extract-subtitles

# Custom headers
transito --user-agent "Custom UA" --referer "https://ref.com" url.m3u8 -o video.mp4

# Dry-run mode (show command)
transito url.m3u8 --dry-run

# Version info
transito --version  # v0.3.0
```

#### 5. **Notifications & Feedback** 🔔

- Native macOS UserNotifications on completion/failure
- Real-time progress bar with visual updates
- Stream metadata display (resolution, bitrate, FPS)
- Inline error messages with full context

#### 6. **Shared Python Engine** 🔧

- New `transito_engine.py` module for code reuse
- HLS master playlist parsing with variant selection
- Robust audio track selection
- Efficient ffmpeg command builders
- Used by both CLI and macOS app

---

## 📁 Files Changed

### New Files (Created)

```
transito_engine.py           # Shared HLS parser and ffmpeg builders
VisualEffectView.swift       # NSViewRepresentable glass wrapper
PreferencesView.swift        # UserDefaults-backed settings form
transito_v03.py              # Draft version (can be removed)
CHANGELOG.md                 # This changelog
```

### Updated Files (Modified)

```
transito.py                  # CLI with subtitle extraction
ContentView.swift            # Complete liquid glass redesign
DownloadManager.swift        # Subtitles, notifications, headers
TransitoApp.swift            # Window config, preferences scene
Version                      # 0.2.0 → 0.3.0
Info.plist (both)            # Bundle version update
```

---

## 🧪 Testing Checklist

### CLI Testing

- [ ] `transito --help` shows new flags
- [ ] `transito --version` returns v0.3.0
- [ ] `transito url.m3u8 -o output.mp4 --dry-run` shows ffmpeg command
- [ ] `transito url.m3u8 -o output.mp4 --extract-subtitles --dry-run` shows both commands
- [ ] Actual download works: `transito [url] -o video.mp4`
- [ ] Subtitle extraction works: creates `video.vtt` file

### macOS App Testing

- [ ] App launches without errors
- [ ] URL drag-drop works
- [ ] Output folder selector works
- [ ] "Extract subtitles" toggle appears
- [ ] Download completes successfully
- [ ] Subtitles saved as `.vtt` when toggled
- [ ] Progress bar updates in real-time
- [ ] Notification appears on completion
- [ ] Preferences window opens (Cmd+,)
- [ ] Settings persist across app restarts

### HLS Variant Testing

- [ ] Master playlist detection works
- [ ] Best resolution variant selected
- [ ] Audio track selection works
- [ ] Stream metadata displayed correctly

### Accessibility Testing

- [ ] VoiceOver reads all labels
- [ ] Focus order is logical
- [ ] Contrast meets WCAG standards
- [ ] Keyboard navigation works

---

## 📊 Metrics

### Code Statistics

- **Python Files**: 2 (transito.py, transito_engine.py)
- **Swift Files**: 5 (app + views)
- **Lines of Code**: ~1,000 new/modified
- **Functions Added**: 6 (HLS parsing, ffmpeg builders)
- **Error Fixes**: 1 maintained (WebVTT codec)

### Features

- **CLI Flags**: 7 (user-agent, referer, extract-subtitles, progress, dry-run, version, help)
- **Preferences**: 4 (folder, UA, Referer, auto-open)
- **Materials**: 3 (hudWindow, thinMaterial, ultraThinMaterial)

---

## 🔄 Migration Notes

### For v0.2.0 Users

- App update recommended for new UI and subtitle support
- Existing downloads unaffected
- Preferences are reset (set defaults in new Settings window)
- No breaking CLI changes (all flags backward compatible)

### For Developers

- **New Dependency**: `transito_engine.py` must be shipped with CLI
- **Python Version**: Requires Python 3.10+ (type hints)
- **Xcode Version**: Swift 5.9+ (SwiftUI requirements)

---

## 🐛 Known Limitations

1. **Subtitle Extraction**

   - Requires ffmpeg 4.1+ with WebVTT encoder
   - Only extracts first subtitle stream (`0:s:0?`)
   - Continues silently if no subtitles available

2. **Progress Reporting**

   - Precision depends on ffmpeg `-progress` output
   - May show 0% briefly on very fast streams

3. **Notifications**

   - Requires User Notification Center opt-in on macOS
   - May not appear if app is in foreground (by design)

4. **Preferences**
   - Folder picker requires disk read/write sandbox entitlements
   - Settings sync not implemented (single-device only)

---

## 🚀 Next Steps (v0.4.0 Roadmap)

- [ ] Batch download queue
- [ ] Video preview thumbnail
- [ ] Format conversion support
- [ ] Download history viewer
- [ ] Custom ffmpeg options UI
- [ ] Windows/Linux native apps
- [ ] iCloud sync for preferences
- [ ] Dark mode theme support

---

## 🔐 Security & Compliance

- ✅ No external API calls (all local processing)
- ✅ No telemetry or tracking
- ✅ Sandbox compliance ready (macOS app store)
- ✅ FFMPEG licensing compatible (MIT compatible)

---

## 📞 Support

For issues or feature requests:

1. Check [CHANGELOG.md](CHANGELOG.md) for known limitations
2. Open an issue on [GitHub](https://github.com/pedrobritx/Transito/issues)
3. Review [README.md](README.md) for troubleshooting

---

## 🙏 Contributors

- **Main Developer**: Pedro Britx
- **Technologies**: SwiftUI, Python 3.10+, ffmpeg 7.x

---

**Build Command**:

```bash
scripts/build_swift_app.sh          # SwiftUI app
scripts/build_macos_app.sh          # Python-based bundle
scripts/release.sh                  # All packages
```

**Git Tags**:

```bash
git tag v0.3.0
git push origin --tags
```

---

**Last Updated**: January XX, 2024
**Release Candidate**: RC1
**Status**: Ready for beta testing
